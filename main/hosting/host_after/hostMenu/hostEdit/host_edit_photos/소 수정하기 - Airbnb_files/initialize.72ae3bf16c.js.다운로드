__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function({datadogTags:t,niobeClient:c}){'undefined'!=typeof Notification&&'denied'===Notification.permission&&(0,o.airdogCount)('service_worker.push_permission_denied',1,t);if(!(0,l.hasPermission)())return;f=t,v=c,h();try{if(!n.default.isLoggedIn())return void(0,u.clearSubscription)();(0,u.updateSubscriptionIfOptedIn)()}catch(t){(0,s.reportError)(t)}},e.getInitializeOptions=async function(){if(!navigator||!navigator.serviceWorker)throw new Error('Push notifications requires a service worker to be available.');const o=await navigator.serviceWorker.ready;if(!o||!o.active)throw new Error('No service worker was activated, push notifications are not available.');if(await Promise.race([w,c.scheduler.wait({delay:3e4})]),!v)throw new Error('Niobe client is required, did you call "initialize"?');const{tracking_context:n}=t.default.get('layout-init'),{controller:s}=n,l='homes-host-loop'===s?'GLOBAL_HOST':'GLOBAL_TRAVEL',u=o.active.scriptURL.split('/'),h="/"+u[u.length-1],b=(0,p.makeDatadogTags)("registered_path:"+h);return{datadogTags:f?[f,b].join(','):b,appType:l,niobeClient:v,pushNotificationsKey:t.default.get('pushNotificationsKey'),serviceWorkerRegistration:o}};var t=babelHelpers.interopRequireDefault(r(d[0])),o=r(d[1]),n=babelHelpers.interopRequireDefault(r(d[2])),s=r(d[3]),c=r(d[4]),l=r(d[5]),u=r(d[6]),p=r(d[7]);let f,v,h;const w=new Promise(t=>{h=t})}),"2bd7f4",["05b07c","08b665","c1939d","5511db","cc3672","afcfc0","1b9d4c","da8ef6"]);
//# sourceMappingURL=https://sourcemaps.d.musta.ch/airbnb/static/packages/web/common/frontend/push-notifications/initialize.2fbc9e78b1.js.map