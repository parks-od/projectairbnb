__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;const n=JSON.parse("{\"kind\":\"Document\",\"definitions\":[{\"kind\":\"OperationDefinition\",\"operation\":\"mutation\",\"name\":{\"kind\":\"Name\",\"value\":\"GetMediaUploadUrl\"},\"variableDefinitions\":[{\"kind\":\"VariableDefinition\",\"variable\":{\"kind\":\"Variable\",\"name\":{\"kind\":\"Name\",\"value\":\"listingId\"}},\"type\":{\"kind\":\"NonNullType\",\"type\":{\"kind\":\"NamedType\",\"name\":{\"kind\":\"Name\",\"value\":\"Long\"}}},\"directives\":[]},{\"kind\":\"VariableDefinition\",\"variable\":{\"kind\":\"Variable\",\"name\":{\"kind\":\"Name\",\"value\":\"fileExtension\"}},\"type\":{\"kind\":\"NamedType\",\"name\":{\"kind\":\"Name\",\"value\":\"MisoMediaUploadSignedUrlFileExtension\"}},\"directives\":[]}],\"directives\":[],\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"miso\"},\"arguments\":[],\"directives\":[],\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"__typename\"},\"arguments\":[],\"directives\":[]},{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"mediaUploadSignedUrl\"},\"arguments\":[{\"kind\":\"Argument\",\"name\":{\"kind\":\"Name\",\"value\":\"request\"},\"value\":{\"kind\":\"ObjectValue\",\"fields\":[{\"kind\":\"ObjectField\",\"name\":{\"kind\":\"Name\",\"value\":\"listingId\"},\"value\":{\"kind\":\"Variable\",\"name\":{\"kind\":\"Name\",\"value\":\"listingId\"}}},{\"kind\":\"ObjectField\",\"name\":{\"kind\":\"Name\",\"value\":\"fileExtension\"},\"value\":{\"kind\":\"Variable\",\"name\":{\"kind\":\"Name\",\"value\":\"fileExtension\"}}}]}}],\"directives\":[],\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"__typename\"},\"arguments\":[],\"directives\":[]},{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"filePath\"},\"arguments\":[],\"directives\":[]},{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"signedUrl\"},\"arguments\":[],\"directives\":[]}]}}]}}]}}],\"operationType\":\"MUTATION\"}");n.operationId="59573a00a3401ea7306126375f9cf5abbc8c2273ffd1ec3ee138544df4a6b9b0",n.integrityHash="ff92978ac85ad49d9c520ec1c7a240cc1c969140d937ef0eb0b78aa308325e25";var t=n;e.default=t}),"062787",[]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;babelHelpers.interopRequireDefault(r(d[0]));var t=babelHelpers.interopRequireDefault(r(d[1])),o=babelHelpers.interopRequireDefault(r(d[2])),l=r(d[3]),n=r(d[4]),s=r(d[5]);var p=(0,l.withStyles)(({dls19:t})=>({footerContainer:{display:'flex',alignItems:'baseline',color:t.palette.hof},caption:{...t.typography.base.md,overflow:'hidden',textOverflow:'ellipsis',whiteSpace:'nowrap'},captionEditButton:{whiteSpace:'nowrap',...t.typography.base.md}}))(({photoLabel:l,readOnly:p,photoEditModalParams:h,textLinkRef:b,onEditPhoto:u,css:f,styles:c})=>{const{caption:y,fullSizeSrc:v}=h,w=y?t.default.t('homes.bys.photoThumbnail.edit_label',{photoLabel:l}):t.default.t('homes.bys.photoThumbnail.addCaption_label',{photoLabel:l}),x=!p&&v&&u;return(0,s.jsxs)("div",{...f(c.footerContainer),children:[y&&(0,s.jsxs)("div",{...f(c.caption),children:[y,"\xa0"]}),x&&(0,s.jsx)(o.default,{"aria-label":w,type:"button",onPress:()=>{u({...h,activeTab:n.PhotoEditModalTabs.DETAILS})},buttonOrAnchorRef:b,children:(0,s.jsx)("div",{...f(c.captionEditButton),children:y?t.default.t('homes.bys.photoThumbnail.edit'):t.default.t('homes.bys.photoThumbnail.addCaption')})})]})});e.default=p}),"0f0387",["d7ed8e","6898d5","b8a532","bf663a","787468","721ed1"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.addNewListingCoverPhoto=function({filePath:t}){return(o,_)=>{const{listingDetails:s}=_(),{listingId:l}=s,h={listing_id:l,new_listing_photo:{image_path:t}};return Promise.resolve(n.default.post("/v2/add_listing_photo/"+l,{data:h})).then(({listing_photos:t})=>{const _=t.filter(t=>t.listing_id_str===l),{id:s,is_cover_eligible:h}=_[_.length-1];h||Promise.reject(Error("Image isn't eligable for cover photo"));const u={listing_id:l,make_cover_photo_id:s};return n.default.put("/v2/update_listing_photos/"+l,{data:u}).then(({listing_photos:t})=>{o({type:p.UPDATE_COVER_PHOTO_SUCCESS,payload:t})}).catch(()=>{o({type:p.UPDATE_COVER_PHOTO_FAILURE})})})}},e.addNewPhoto=function({media:o,destListingId:_,destFacilityId:s,sendGPS:l}){return h=>o.filePath?(l?t.default.gps(o.picture.file).catch(()=>{}):Promise.resolve(void 0)).then(t=>{const l=t?{lat:t.latitude,lng:t.longitude}:{},u={listing_id:_,new_listing_photo:{image_path:o.filePath,...o.uploadedAt?{image_uploaded_at:o.uploadedAt}:{},...o.fileSize?{image_file_size:o.fileSize}:{},...o.imageWidth?{image_width:o.imageWidth}:{},...o.imageHeight?{image_height:o.imageHeight}:{},...s?{room_id:s}:{},...l}};return Promise.all([h({type:p.ADD_PHOTO_REQUEST}),n.default.post("/v2/add_listing_photo/"+_,{data:u}).then(({listing_photos:t})=>(h({type:p.ADD_PHOTO_REQUEST_SUCCESS,payload:t}),t)).catch(()=>{h({type:p.ADD_PHOTO_REQUEST_FAILURE})})])}):Promise.reject()},e.appendLocalMediaItem=function(t,o){return{type:p.APPEND_LOCAL_MEDIA_ITEM,payload:{mediaKey:t,mediaItem:o}}},e.changeRoom=function({listingId:t,roomId:o,photoIds:_}){return s=>{s({type:p.CHANGE_ROOM_START,payload:{roomId:o,photoIds:_}});const l={data:{destination:{listing_id:t,room_id:o},photosToMove:_.map(o=>({listing_id:t,picture_id:o}))}};return n.default.post("/v2/move_listing_photos",l).then(({success_count:o,listing_photos:n})=>{if(o===_.length)return s({type:p.CHANGE_ROOM_SUCCESS,payload:{listingPhotos:n[t],photoIds:_,listingId:t}}),n[t]}).catch(t=>{throw s({type:p.CHANGE_ROOM_FAILED,payload:{photoIds:_}}),t})}},e.clearEditedPhotoIds=function(){return{type:p.CLEAR_EDITED_PHOTO_IDS}},e.deletePhoto=function({photoId:t}){return o=>{if(!t)return Promise.reject();const[_,s]=t.split('_'),l={listing_id:_,delete_photo_id:parseInt(s,10)};return Promise.resolve(n.default.put("/v2/update_listing_photos/"+_,{data:l})).then(({listing_photos:t})=>(o({type:p.DELETE_PHOTO_REQUEST_SUCCESS,payload:{deletedPhotoId:s}}),t)).catch(()=>{o({type:p.DELETE_PHOTO_REQUEST_FAILURE})})}},e.fetchManageListingPhotos=u,e.forceReloadFetchManageListingPhotos=function(t){const o={force:!0,strategy:'replace'};return n=>Promise.all([n({type:p.FORCE_REPLACE_MANAGE_LISTING_PHOTOS}),n(u(t,o))])},e.hideChangeCoverPhotoModal=function(){return{type:p.HIDE_CHOOSE_COVER_PHOTO_MODAL}},e.hidePhotoLoadingScreen=function(){return{type:p.HIDE_PHOTO_LOADING_SCREEN}},e.misoManageListingPhotosRequest=void 0,e.moveListingPhotos=function({destinationId:t,destinationFacilityId:o,pictureIds:_=[],forceRefetch:s=!0}){return l=>{const h={destination:{listing_id:t,room_id:o},photosToMove:_.map(t=>{const[o,n]=t.split('_');return{listing_id:o,picture_id:parseInt(n,10)}})},u=()=>n.default.post("/v2/move_listing_photos",{data:h});return s?u().then(({listing_photos:t})=>{l({type:p.MOVE_PHOTO_REQUEST_SUCCESS,payload:t})}).catch(()=>{l({type:p.MOVE_PHOTO_REQUEST_FAILURE})}):u()}},e.patchPhotoOrders=function({listingId:t,photos:o,rooms:_}){return s=>{let l=new Set;const h=new Map;o.forEach(t=>{const o=t.room_id;h.has(o)||h.set(o,[]),h.get(o).push(t)}),_.forEach(({room_id:t})=>{l=new Set([...l,...h.get(t)||[]])}),l=new Set([...l,...o]),n.default.put("/v2/update_listing_photos/"+t,{data:{listing_id:t,ordered_photo_ids:[...l].map(t=>t.id)}}).catch(()=>{s({type:p.REORDER_LISTING_PHOTOS,payload:{orderedPhotos:o}})}),s({type:p.REORDER_LISTING_PHOTOS,payload:{orderedPhotos:[...l]}})}},e.removeLocalMediaItem=function(t,o){return{type:p.REMOVE_LOCAL_MEDIA_ITEM,payload:{mediaKey:t,id:o}}},e.removeLocalMediaItems=function(t){return{type:p.REMOVE_LOCAL_MEDIA_ITEMS,payload:{mediaInfosToDelete:t}}},e.saveEditChanges=function(t,o,n){return _=>Promise.all([_({type:p.UPDATE_PHOTO_REQUESTED}),c(t,o,n)]).then(n=>{const l=n[1].listing_photos;return Promise.all([_({type:p.EDIT_PHOTO_REPLACEMENT_SUCCESS,payload:{manageListingPhotos:l,listingId:t,previousId:o}}),_((0,s.fetchListingDetails)({id:t,force:!0,strategy:'replace'}))])}).then(()=>{_({type:p.UPDATE_PHOTO_SUCCESS})}).catch(()=>{_({type:p.UPDATE_PHOTO_FAILURE})})},e.saveEditedPhoto=function(t,o){var _;const[s,p]=null!==(_=null==t?void 0:t.split('_'))&&void 0!==_?_:[];return()=>(function(t,o,_){if(!t.filePath)return Promise.reject();const s={old_photo_id:o,listing_id:_,replacement_photo:{image_path:t.filePath}};t.uploadedAt&&(s.replacement_photo.image_uploaded_at=new Date(Number(t.uploadedAt)).toISOString());t.fileSize&&(s.replacement_photo.image_file_size=t.fileSize);t.imageWidth&&(s.replacement_photo.image_width=t.imageWidth);t.imageHeight&&(s.replacement_photo.image_height=t.imageHeight);return Promise.resolve(n.default.post("/v2/replace_listing_photo/"+_,{data:s}))})(o,p,s)},e.saveNewCoverPhoto=function(t,o,_){const s={id:t,data:{make_cover_photo_id:o}};return t=>Promise.all([t({type:p.UPDATE_COVER_PHOTO_REQUEST}),n.default.put("/v2/update_listing_photos/"+s.id,s).then(o=>{l.default.dragPhotoOrderChanged({dragIndex:_,hoverIndex:0}),t({type:p.UPDATE_COVER_PHOTO_SUCCESS,payload:o.listing_photos})}).catch(o=>{t({type:p.UPDATE_COVER_PHOTO_FAILURE,payload:o.listing_photos})})])},e.setSelectedCoverPhoto=function({id:t}){return(o,_)=>{const{listingDetails:s}=_(),{listingId:l}=s,h={listing_id:l,make_cover_photo_id:t};return Promise.all([o({type:p.UPDATE_COVER_PHOTO_REQUEST}),n.default.put("/v2/update_listing_photos/"+l,{data:h}).then(({listing_photos:t})=>{o({type:p.UPDATE_COVER_PHOTO_SUCCESS,payload:t})}).catch(()=>{o({type:p.UPDATE_COVER_PHOTO_FAILURE})})])}},e.showChangeCoverPhotoModal=function(){return{type:p.SHOW_CHOOSE_COVER_PHOTO_MODAL}},e.updateCoverPhotoRequest=function(){return{type:p.UPDATE_COVER_PHOTO_REQUEST}},e.updateLocalMediaItem=function(t,o){return{type:p.UPDATE_LOCAL_MEDIA_ITEM,payload:{mediaKey:t,updates:o}}},e.updatePhotoFailure=function(){return{type:p.UPDATE_PHOTO_FAILURE}},e.updatePhotoRequested=function(){return{type:p.UPDATE_PHOTO_REQUESTED}},e.updatePhotoSuccess=function(){return{type:p.UPDATE_PHOTO_SUCCESS}},e.updatePhotosList=E,e.updatingListingPhoto=function({photoId:t,sortOrder:o,caption:_}){if(!t)return()=>Promise.reject();const[s,p]=t.split('_'),l={listing_id:s,photo_id:parseInt(p,10)};'number'==typeof o&&(l.sort_order=o);'string'==typeof _&&(l.caption=_);return t=>n.default.put("/v2/update_listing_photos/"+s,{data:l}).then(o=>t(E(o.listing_photos)))};var t=babelHelpers.interopRequireDefault(r(d[0])),o=r(d[1]),n=babelHelpers.interopRequireDefault(r(d[2])),_=r(d[3]),s=(babelHelpers.interopRequireDefault(r(d[4])),r(d[5]),r(d[6])),p=(r(d[7]),r(d[8])),l=babelHelpers.interopRequireDefault(r(d[9]));const{fetchMember:h}=(0,o.createResourceActions)({resource:_.MisoManageListingPhotosResource,schema:_.MisoManageListingPhotosSchema});function u(t,o={}){const n={id:t,format:'default',...o};return t=>Promise.all([t({type:p.FETCH_MANAGE_LISTING_PHOTOS_REQUEST}),t(h(n)).then(o=>{t({type:p.FETCH_MANAGE_LISTING_PHOTOS_SUCCESS,payload:o.listing_photos})}).catch(o=>{t({type:p.FETCH_MANAGE_LISTING_PHOTOS_FAILURE,payload:o.listing_photos})})])}function c(t,o,_){const s={json_root_body:`{"listing_id": ${t}}`,image:_};return new Promise(_=>n.default.post("/v2/listing_photos?_format=upload_only",{data:s}).then(s=>{const p=s.listing_photo,l={old_photo_id:o,listing_id:t,replacement_photo:{image_path:p.image_uploaded_path,image_uploaded_at:new Date(p.image_updated_at).toISOString(),image_file_size:p.image_file_size,image_width:p.image_width,image_height:p.image_height}};_(n.default.post("/v2/replace_listing_photo/"+t,{data:l}))}))}function E(t){return{type:p.UPDATE_PHOTOS_LIST,payload:t}}e.misoManageListingPhotosRequest=h}),"0f7cb8",["ff1dfa","f8e8b1","df4f90","03c317","56c689","48302c","ea1a1d","73d352","eb3ad8","8165be"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.PurePhotoCategoryContainer=void 0,e.onSavePhotoModalUpdates=R;var o=babelHelpers.interopRequireWildcard(r(d[0])),t=babelHelpers.interopRequireDefault(r(d[1])),n=babelHelpers.interopRequireDefault(r(d[2])),s=babelHelpers.interopRequireDefault(r(d[3]));function l(){const o=r(d[4]);return l=function(){return o},o}var h=r(d[5]),p=babelHelpers.interopRequireDefault(r(d[6])),c=babelHelpers.interopRequireDefault(r(d[7])),u=babelHelpers.interopRequireDefault(r(d[8])),I=babelHelpers.interopRequireDefault(r(d[9])),f=r(d[10]),P=r(d[11]),v=babelHelpers.interopRequireDefault(r(d[12])),M=r(d[13]),b=r(d[14]),y=r(d[15]),E=r(d[16]),L=babelHelpers.interopRequireDefault(r(d[17])),S=r(d[18]),_=babelHelpers.interopRequireDefault(r(d[19])),C=r(d[20]);function D(o,t){return o.sort_order-t.sort_order}function R({photoId:o,image:t,caption:n,onUpdatePhoto:s,saveEditedPhoto:l,handleFetchManageListingPhotos:h}){if(!o)return Promise.reject();return Promise.resolve().then(()=>'string'==typeof n?s({photoId:o,caption:n}):Promise.resolve()).then(()=>t?l(o,t):Promise.resolve()).catch(()=>{}).finally(h)}const O=function(s){const{config:h,listingId:M,localMediaInfos:b,isFetchingPhotos:y,listingPhotos:O,saveEditedPhoto:U,onSaveMedia:x,onAppendMediaItem:H,onUpdateMediaItem:T,onRemoveMediaItem:w,onRemoveMediaItems:A,onUpdatePhoto:j,onDeleteMedia:q,fetchManageListingPhotos:k,onMoveListingPhoto:F,sectionsPhotoIdsMap:N,sortedPhotoIds:$,rooms:B,updatePhotoOrders:z,assignmentOptions:K,css:G,styles:W}=s,{roomId:Y,sectionIndex:J,minPhotos:Q,maxPhotos:V,roomName:X,sectionGuidelines:Z,alwaysShowDropdown:ee,totalLimit:oe,readOnly:te,isUnassignedSection:ie,photoLevelErrorDisplay:ne,validators:se,enableCategorization:ae,enableUploadPhotoButton:de}=h,le=Y,re=(0,L.default)(se),[he,pe]=(0,o.useState)([]),[ce,ue]=(0,o.useState)([]),me=(0,o.useRef)([]),[ge,Ie]=(0,o.useState)(null),[fe,Pe]=(0,o.useState)(),ve=(0,o.useMemo)(()=>{const o=N[Y]||[];return(ae?O.filter(t=>ie?!$.includes(t.id):o.includes(t.id)):O).sort(D).map(o=>({id:o.id,photoId:`${o.listing_id_str}_${o.id}`,src:o.large_url,fullSizeSrc:o.full_size_url,caption:o.caption,sortOrder:o.sort_order,isPortrait:!o.is_cover_eligible||'vertical'===o.orientation}))},[Y,O,N[Y],$,ae,ie,N]),Me=(0,o.useMemo)(()=>{const o=b.filter(o=>o.mediaKey===le);if(!ie)return o;const t=b.filter(o=>o.mediaKey===E.ALL_PHOTOS_UPLOADER_MEDIA_KEY).filter(P.filterShowingMediaInfo);return o.concat(t).sort(P.sortMediaItemsByCreatedAt)},[b,le,ie]),be=(0,o.useMemo)(()=>!(ie&&0!==O.length&&0===ve.length&&0===Me.length),[ie,O,ve,Me]),ye=(0,o.useMemo)(()=>{const o=V?V-ve.length:void 0,t=oe?oe-O.length:void 0;return o&&t?Math.min(o,t):o||t},[V,oe,ve,O]),[Ee]=(0,l().useApolloMutation)(v.default),Le=o=>Ee({variables:{...o,listingId:M}}),Se=(0,o.useCallback)(()=>k(M),[k,M]),_e=(0,o.useCallback)(o=>{H(le,o);const t=Y.split('_')[1],n=t?Number(t):void 0,s=o.uploadState===P.UploadState.FAILED?{success:!1,errorType:o.errorType}:{};(0,S.logPhotoClassifyEvent)(M,'mys.photo.add',{roomId:n,...s})},[M,Y,le,H]),Ce=(0,o.useRef)({}),De=(0,o.useCallback)(o=>{te||(Pe(o.photoId),Ie(o),(0,S.logPhotoClassifyEvent)(M,'mys.photo.detail'))},[M,te]),Re=(0,o.useCallback)(()=>{y||(pe(ve.map(o=>o.photoId)),ue(ve.map(o=>o.sortOrder)))},[ve,y]),Oe=o=>{if(0===me.current.length)return ae&&null!=o&&o.length&&z({rooms:B,photos:o,listingId:M}),Promise.resolve();let t=[];const n=me.current[0];return j?j(n).then(({payload:o})=>{t=o}).finally(()=>(me.current.shift(),Oe(t))):Promise.reject()};(0,o.useEffect)(()=>{Re()},[Re]);const Ue=(0,o.useCallback)(o=>{q(o).then(o=>{ae&&z({rooms:B,photos:o,listingId:M})}),(0,S.logPhotoClassifyEvent)(M,'mys.photo.remove')},[B,M,q,ae,z]),xe=(0,o.useCallback)(o=>{F(o).then(o=>{ae&&z({rooms:B,photos:o,listingId:M})}),(0,S.logPhotoClassifyEvent)(M,'mys.photo.photo_room.edit')},[B,M,F,ae,z]),He=(0,o.useCallback)(o=>{x(o).then(o=>{if(o[1]&&ae){const t=o[1];z({rooms:B,photos:t,listingId:M}),(0,S.logPhotoClassifyEvent)(M,'mys.photo.add.success')}}).catch(o=>((0,S.logPhotoClassifyEvent)(M,'mys.photo.add.error'),Promise.reject(o)))},[B,ae,M,x,z]);return be?(0,C.jsxs)("div",{...G(W.container),children:[(0,C.jsx)(p.default,{listingId:M,sectionId:Y,photos:ve,maxPhotos:V||void 0,minPhotos:Q||void 0,capacity:ye,alwaysShowDropdown:!(!ae||null===ee)&&ee,readOnly:!!te,sectionIndex:J||0,mediaInfos:Me,showPhotoLevelError:ne||void 0,validatorOptions:re,photoIds:he,renderAddPhoto:o=>(0,C.jsx)(I.default,{...o,text:t.default.t('homes.bys.sectionPhotos.addMore')}),renderHeader:({onUploadMedia:o})=>(0,C.jsx)(c.default,{title:X||void 0,sectionGuidelines:Z||void 0,enableUploadPhotoButton:!!de,onUploadMedia:o}),renderPhotoThumbnailFooter:o=>(0,C.jsx)(u.default,{...o,readOnly:!!te,onEditPhoto:De,textLinkRef:t=>((o,t)=>{Ce.current[t]=o})(t,o.photoId)}),getMediaUploadSignedUrl:Le,onAppendMediaItem:_e,onSaveMedia:He,onUpdateMediaItem:T,onRemoveMediaItem:w,onRemoveMediaItems:A,onReorderPhoto:(o,t)=>(me.current.push({photoId:o,sortOrder:ce[t-1]}),1===me.current.length?Oe():Promise.reject()),onMoveCard:({dragIndex:o,photoId:t,hoverIndex:s})=>{const l=(0,n.default)(he,{$splice:[[o,1],[s,0,t]]});pe(l)},onDropCard:({dropIndex:o,dropId:t,sortOrder:n})=>{const s=ce[o];s&&s!==n&&(me.current.push({photoId:t,sortOrder:s}),1===me.current.length&&Oe(),(0,S.logPhotoClassifyEvent)(M,'mys.photo.order.edit'))},onCancelMove:Re,onShowEditModal:De,onDeleteMedia:Ue,assignmentOptions:ae?K:void 0,onMoveListingPhoto:xe,isUnassignedSection:ie}),!te&&(0,C.jsx)(_.default,{isOpen:!!ge,tabs:[f.PhotoEditModalTabs.DETAILS,f.PhotoEditModalTabs.EDIT],activeTab:null==ge?void 0:ge.activeTab,photo:ge,caption:null==ge?void 0:ge.caption,onClose:()=>{Ie(null),fe&&setTimeout(()=>{var o;null==Ce||null===(o=Ce.current[fe])||void 0===o||o.focus()},500)},onSave:({photoId:o,image:t,caption:n,newSectionId:s})=>(Object.entries({'mys.photo.caption.save':n,'mys.photo.image.edit':t}).forEach(([o,t])=>{t&&(0,S.logPhotoClassifyEvent)(M,o)}),R({photoId:o,image:t,caption:n,newSectionId:s,onUpdatePhoto:j,saveEditedPhoto:U,handleFetchManageListingPhotos:Se,rooms:B,listingId:M})),label:t.default.t('homes.bys.photoEditModal.accessibleTitle'),getMediaUploadSignedUrl:Le,altActionText:null!=ge&&ge.canDelete?t.default.t('homes.bys.photoEditModal.deletePhoto'):null,altActionHandler:null!=ge&&ge.canDelete?()=>Ue(ge.photoId):null})]}):null};e.PurePhotoCategoryContainer=O;var U=(0,s.default)(o=>{const{manageListingPhotos:n,listingDetails:s,entities:l}=o,{manageListingPhotos:h=[],isLoadingManageListingPhotos:p,localMediaInfos:c}=n,{listingId:u}=s,I=l.getEntity(b.HomeTourListingSchema,u),f=(0,y.getSortedRooms)((null==I?void 0:I.rooms)||[]).map(({room_id:o,room_name:t})=>({label:t,sectionId:`${u}_${o}`})),P=(null==n?void 0:n.sectionsPhotoIdsMap)||{};let v=[];return f.forEach(({sectionId:o})=>{const t=P[o]||[];v=v.concat(t)}),f.push({label:t.default.t('homes.bys.photoEditModal.assignmentOptions.other.label'),sectionId:u}),{isFetchingPhotos:p,localMediaInfos:c,listingPhotos:h,assignmentOptions:{[t.default.t('homes.bys.photoEditModal.assignmentOptions.label')]:f},rooms:I.rooms,sectionsPhotoIdsMap:P,sortedPhotoIds:v}},o=>({onSaveMedia:({media:t,sectionId:n})=>{const[s,l]=n.split('_');return o((0,M.addNewPhoto)({media:t,destListingId:s,destFacilityId:l}))},onDeleteMedia:t=>o((0,M.deletePhoto)({photoId:t})),onAppendMediaItem:(t,n)=>o((0,M.appendLocalMediaItem)(t,n)),onUpdateMediaItem:(t,n)=>o((0,M.updateLocalMediaItem)(t,n)),onRemoveMediaItem:(t,n)=>o((0,M.removeLocalMediaItem)(t,n)),onRemoveMediaItems:t=>o((0,M.removeLocalMediaItems)(t)),onUpdatePhoto:({photoId:t,...n})=>o((0,M.updatingListingPhoto)({photoId:t,...n})),fetchManageListingPhotos:t=>{o((0,M.fetchManageListingPhotos)(t,{force:!0}))},saveEditedPhoto:(t,n)=>o((0,M.saveEditedPhoto)(t,n)),onMoveListingPhoto:t=>{const{photoId:n,sectionId:s}=t;if(!n||!s)return;const[l,h]=s.split('_'),p='other'===h?void 0:Number(h);return o((0,M.changeRoom)({listingId:l,roomId:p,photoIds:[Number(n.split('_')[1])]}))},updatePhotoOrders:({rooms:t,listingId:n,photos:s})=>{o((0,M.patchPhotoOrders)({rooms:t,listingId:n,photos:s}))}}))((0,h.withStyles)(({dls19:o})=>({container:{borderBottom:"1px solid "+o.palette.deco,padding:o.spacing.macro48px+" 0",maxWidth:900}}))(O));e.default=U}),"4ded0b",["d7ed8e","6898d5","9feafd","9770cb","8bbed0","bf663a","08a2b4","6caf7f","0f0387","946980","787468","b4bb20","062787","0f7cb8","03c317","73d352","e8e38a","92c39f","ca8556","bef7d4","721ed1"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=new(babelHelpers.interopRequireDefault(r(d[0])).default)({deserialize:t=>'string'==typeof t?JSON.parse(t):t});e.default=t}),"50961b",["c8bd7d"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;babelHelpers.interopRequireDefault(r(d[0]));var t=babelHelpers.interopRequireDefault(r(d[1])),l=r(d[2]),n=babelHelpers.interopRequireDefault(r(d[3])),o=babelHelpers.interopRequireDefault(r(d[4])),s=r(d[5]);var u=(0,l.withStyles)(({dls19:t})=>({header:{marginBottom:t.spacing.macro24px},titleContainer:{display:'flex',justifyContent:'space-between',alignItems:'flex-start'},title:{...t.typography.base.lg,marginBottom:t.spacing.micro4px,fontWeight:t.typography.weight.bold},sectionGuidelinesContainer:{fontWeight:t.typography.weight.book},listAnimation:{...o.default.styles}}))((function({styles:l,css:o,title:u,sectionGuidelines:p,enableUploadPhotoButton:h,shouldAnimate:c=!1,onUploadMedia:f}){return u||p?(0,s.jsxs)("div",{...o(l.header),children:[u&&(0,s.jsxs)("div",{...o(l.titleContainer,c&&l.listAnimation),children:[(0,s.jsx)("div",{...o(l.title),children:u}),h&&(0,s.jsx)(n.default,{onPress:f,children:t.default.t('homes.bys.sectionPhotos.add.photo')})]}),(0,s.jsx)("div",{...o(l.sectionGuidelinesContainer,c&&l.listAnimation),children:p?p+" ":null})]}):null}));e.default=u}),"6caf7f",["d7ed8e","6898d5","bf663a","b8a532","77229f","721ed1"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getImageFileExtension=function(o){var t,s;const p=null===(t=o.split('.').pop())||void 0===t?void 0:t.toUpperCase();return null!==(s={JPEG:'JPEG',JPG:'JPEG',PNG:'PNG'}[p])&&void 0!==s?s:null},e.getPhotosMap=function(o,s){const p={},n=new Set([t.PhotoImageType.PREVIEW,t.PhotoImageType.MOVING]),_=[],u=new Map;return o.forEach(o=>{const t=o,s=o;n.has(t.type)?_.push(t):u.set(s.id,s)}),s.forEach(o=>{const t=o.room_id;p[t]=[],o.photo_ids.forEach(o=>{const s=u.get(o);s&&p[t].push(s),u.delete(o)})}),p.other=[...u.values()],_.forEach(o=>{p[o.room_id||'other'].push(o)}),p},e.getSortedRooms=function(s){const p=[],n=[],_=[],u=[];let l=0,h=0,c=0,f=0,E=0,y=0;return s.forEach(o=>{const s=o.room_type;s===t.RoomTypeEnum.BEDROOM?f++:s===t.RoomTypeEnum.FULL_BATHROOM?E++:s===t.RoomTypeEnum.HALF_BATHROOM&&y++}),s.forEach(s=>{const R=s.room_type;if(R===t.RoomTypeEnum.BEDROOM){l+=1;const t=`${o.default.t('list_your_space.photos_step.listing_photo_step_v2.rooms_bedroom')}${f<=1?'':" "+l}`;p.push({...s,room_name:t})}else if(R===t.RoomTypeEnum.FULL_BATHROOM){h+=1;const t=`${o.default.t('list_your_space.photos_step.listing_photo_step_v2.rooms_full_bathroom')}${E<=1?'':" "+h}`;n.push({...s,room_name:t})}else if(R===t.RoomTypeEnum.HALF_BATHROOM){c+=1;const t=`${o.default.t('list_your_space.photos_step.listing_photo_step_v2.room_half_bathroom')}${y<=1?'':" "+c}`;_.push({...s,room_name:t})}else u.push(s)}),[...p,...n,..._,...u]};var o=babelHelpers.interopRequireDefault(r(d[0])),t=r(d[1])}),"73d352",["6898d5","48302c"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=babelHelpers.interopRequireDefault(r(d[0]));class t{constructor(){this.generateActions=this.generateActions,this.generateActions('clickedClosePictureModal','clickedOpenEditModal','clickedPhotoItem','previewAdded','generatePreviewSrc','photoImageLoaded','updateUploadProgress','uploadStarted','uploadSuccess','updateEarlyReturned','uploadError','createPreviewPhoto','deleteStarted','deleteSuccess','deleteFromRoom','deleteRequested','deleteError','updateOrder','updateCaptionSuccess','updateCaptionError','resolutionInfoAdded','dragPhotoOrderChanged','setRooms','sortPhotos','movePhotosStarted','movePhotosSuccess','movePhotosFailed','fetchedPhotos','toggleModal','addPhotoUploadError','removeErrorPreviewPhoto','showPhotoUploadError')}}t.displayName='ListingPhotoActions';var s=o.default.createActions(t);e.default=s}),"8165be",["50961b"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(u){return(0,t.useMemo)(()=>{const t={};return(u||[]).forEach(u=>{if(!u)return;['booleanValue','integerValue','stringValue'].some(n=>n in u.validatorValue&&(t[u.validatorName]=u.validatorValue[n],!0))}),t},[u])};var t=r(d[0])}),"92c39f",["d7ed8e"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]),n=Object.prototype.hasOwnProperty,o=Array.prototype.splice,c=Object.assign||function(t,o){return u(o).forEach((function(c){n.call(o,c)&&(t[c]=o[c])})),t},u='function'==typeof Object.getOwnPropertySymbols?function(t){return Object.keys(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.keys(t)};function s(t){if(t instanceof Array)return c(t.constructor(t.length),t);if(t&&'object'==typeof t){var n=t.constructor&&t.constructor.prototype;return c(Object.create(n||null),t)}return t}function p(){var o=c({},y);return p.extend=function(t,n){o[t]=n},p.isEquals=function(t,n){return t===n},p;function p(c,y){Array.isArray(c)&&Array.isArray(y)||t(!Array.isArray(y),"update(): You provided an invalid spec to update(). The spec may not contain an array except as the value of $set, $push, $unshift, $splice or any custom command allowing an array value."),t('object'==typeof y&&null!==y,"update(): You provided an invalid spec to update(). The spec and every included key path must be plain objects containing one of the following commands: %s.",Object.keys(o).join(', '));var f=c;return u(y).forEach((function(t){if(n.call(o,t)){var u=c===f;f=o[t](y[t],f,y,c),u&&p.isEquals(f,c)&&(f=c)}else{var l=p(c[t],y[t]);p.isEquals(l,f[t])&&(void 0!==l||n.call(c,t))||(f===c&&(f=s(c)),f[t]=l)}})),f}}var y={$push:function(t,n,o){return f(n,o,'$push'),t.length?n.concat(t):n},$unshift:function(t,n,o){return f(n,o,'$unshift'),t.length?t.concat(n):n},$splice:function(n,c,u,p){return(function(n,o){t(Array.isArray(n),'Expected $splice target to be an array; got %s',n),l(o.$splice)})(c,u),n.forEach((function(t){l(t),c===p&&t.length&&(c=s(p)),o.apply(c,t)})),c},$set:function(n,o,c){return(function(n){t(1===Object.keys(n).length,'Cannot have more than one key in an object with $set')})(c),n},$toggle:function(n,o){var c;c=n,t(Array.isArray(c),"update(): expected spec of $toggle to be an array; got %s. Did you forget to wrap the key(s) in an array?",c);var u=n.length?s(o):o;return n.forEach((function(t){u[t]=!o[t]})),u},$unset:function(n,o,c,u){return t(Array.isArray(n),"update(): expected spec of $unset to be an array; got %s. Did you forget to wrap the key(s) in an array?",n),n.forEach((function(t){Object.hasOwnProperty.call(o,t)&&(o===u&&(o=s(u)),delete o[t])})),o},$merge:function(n,o,c,p){var y,f;return y=o,t((f=n)&&'object'==typeof f,'update(): $merge expects a spec of type \'object\'; got %s',f),t(y&&'object'==typeof y,'update(): $merge expects a target of type \'object\'; got %s',y),u(n).forEach((function(t){n[t]!==o[t]&&(o===p&&(o=s(p)),o[t]=n[t])})),o},$apply:function(n,o){var c;return t('function'==typeof(c=n),'update(): expected spec of $apply to be a function; got %s.',c),n(o)}};function f(n,o,c){t(Array.isArray(n),'update(): expected target of %s to be an array; got %s.',c,n);var u=o[c];t(Array.isArray(u),"update(): expected spec of %s to be an array; got %s. Did you forget to wrap your parameter in an array?",c,u)}function l(n){t(Array.isArray(n),"update(): expected spec of $splice to be an array of arrays; got %s. Did you forget to wrap your parameters in an array?",n)}m.exports=p(),m.exports.newContext=p}),"9feafd",["0b1a27"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(o){return(0,l.jsx)(t.default,{loader:n,renderPlaceholder:t.renderNull,...o})};babelHelpers.interopRequireDefault(r(d[0]));var t=babelHelpers.interopRequireWildcard(r(d[1])),l=r(d[2]);function n(){return r(d[4])(d[3],"./../../../host-dls/components/photos/PhotoEditModal").then(babelHelpers.interopRequireWildcard).then(t=>t.default||t)}}),"bef7d4",["d7ed8e","58c24c","721ed1","787468","b8ad06"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.COVER_PHOTOS_UPLOADER_MEDIA_KEY=e.ALL_PHOTOS_UPLOADER_MEDIA_KEY=void 0;e.COVER_PHOTOS_UPLOADER_MEDIA_KEY='COVER_PHOTOS_UPLOADER_MEDIA_KEY';e.ALL_PHOTOS_UPLOADER_MEDIA_KEY='ALL_PHOTOS_UPLOADER_MEDIA_KEY'}),"e8e38a",[]);
__r("6898d5").extend({"homes.bys.photoThumbnail.edit_label":"%{photoLabel} 수정","homes.bys.photoThumbnail.addCaption_label":"%{photoLabel}에 설명 추가","homes.bys.photoThumbnail.edit":"수정하기","homes.bys.photoThumbnail.addCaption":"설명 추가하기","homes.bys.photoEditModal.assignmentOptions.other.label":"other","homes.bys.photoEditModal.assignmentOptions.label":"Space","homes.bys.sectionPhotos.addMore":"더 추가하기","homes.bys.photoEditModal.accessibleTitle":"사진 수정 모달","homes.bys.photoEditModal.deletePhoto":"사진 삭제","homes.bys.sectionPhotos.add.photo":"사진 추가하기","list_your_space.photos_step.listing_photo_step_v2.rooms_bedroom":"Bedroom","list_your_space.photos_step.listing_photo_step_v2.rooms_full_bathroom":"bathroom","list_your_space.photos_step.listing_photo_step_v2.room_half_bathroom":"half bathroom"});
//# sourceMappingURL=https://sourcemaps.d.musta.ch/airbnb/static/packages/web/common/frontend/manage-your-space/containers/PhotoCategoryContainer.c583061853.js.map